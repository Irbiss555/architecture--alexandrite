### 1. Идентифицированные проблемы

#### 1. Масштабируемость и производительность

-   Один инстанс на каждый контейнер (API, UI) → узкое место при росте заказов.

-   MES тормозит при открытии дашборда — неэффективный запрос или отсутствие индексов.


#### 2. Низкая наблюдаемость

- Невозможно понять, где "застрял" заказ (отсутствие трейсинга).


#### 3. Проблемы API

- Массовое поступление заказов через открытый API перегружает CRM.

- API-интеграция хрупкая, требует контроля SLA и троттлинга.

#### 4. Пользовательские жалобы

- Нет приоритизации новых заказов — MES показывает их в случайном порядке.

#### 5. Процессы разработки

- Частые задержки релизов из-за отсутствия автотестов и ручного QA.


##
### 2. Инициативы для устранения проблем

1. Добавить горизонтальное масштабирование API и UI компонентов.

2. Внедрить трейсинг заказов по всей цепочке.

3. Добавить полноценный мониторинг (CPU, RPS, latency, и т.д.).

4. Внедрить кеширование дашборда MES.

5. Переосмыслить структуру запроса MES-дашборда (отложенная загрузка, приоритетность).

6. Внедрить логирование ключевых событий (изменение статусов, ошибки).

7. Добавить ограничение RPS и авторизацию на API для партнёров.

8. Переработать CI/CD: автоматизация E2E-тестов, интеграция SonarQube и автодеплой в release.

9. Добавить фоновый воркер в MES для поочерёдной обработки сложных моделей.

10. Переход на контейнеризацию и autoscaling (например, через Yandex Managed Kubernetes).

11. Ввести SLA-мониторинг API и алерты по просрочкам заказов.

##
### 3. Приоритизация инициатив
#### Высокий приоритет (срочные проблемы, влияние на деньги и UX):
1. Внедрить трейсинг заказов (инициатива 2) — чтобы понимать, где теряется заказ.

2. Внедрить мониторинг и алерты (3, 7) — CPU, RPS, задержки → это срочно.

3. Оптимизация MES-дэшборда (инициативы 4 и 5) — влияет на мотивацию операторов и выполнение заказов.

#### Средний приоритет:
1. Кеширование (инициатива 4).

2. Ограничения на API (инициатива 8).

3. Логирование (инициатива 6).

4. Переработка CI/CD (инициатива 9).

#### Низкий приоритет (долгосрочные инициативы):
1. Горизонтальное масштабирование (1).

2. Контейнеризация и autoscaling (11).

3. SLA и автоматические тикеты по проблемам (12).

##
### 4. Целевая архитектура через 6 месяцев
- Все API масштабируются горизонтально.

- Работает трассировка заказов (доступна через интерфейс поддержки).

- Внедрён мониторинг (Grafana, Prometheus, Loki, DLQ по RabbitMQ).

- MES-дэшборд работает быстро, пользователи видят заказы в реальном времени.

- Работает кеширование: частые запросы, медленные расчёты не нагружают базу.

- Заказы не теряются, можно отследить любое изменение и баг.

- CI/CD полностью автоматизирован до релиза.

